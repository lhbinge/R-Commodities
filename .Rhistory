toets[1,n+2] <- 100
toets[i,n+2] <- toets[i-1,n+2]*toets[i,n+1]
w
data <- data[,-1]
data <- na.locf(data, na.rm=FALSE, fromLast=TRUE)
m <- ts(data,start=c(1889,10), end= c(1914,8), frequency = 12)
dec <- decompose(m, "additive")
toets <- as.data.frame(m - dec$seasonal)
n <- ncol(toets)
toets[i,1:n] <- data[i,1:n]/data[(i-1),1:n]
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
toets[i,1:n]
data <- crops
data <- data[,-1]
data <- na.locf(data, na.rm=FALSE, fromLast=TRUE)
m <- ts(data,start=c(1889,10), end= c(1914,8), frequency = 12)
dec <- decompose(m, "additive")
toets <- as.data.frame(m - dec$seasonal)
n <- ncol(toets)
toets[i,1:n] <- data[i,1:n]/data[(i-1),1:n]
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
toets[1,n+2] <- 100
toets[i,n+2] <- toets[i-1,n+2]*toets[i,n+1]
for(i in 2:299) {
toets[i,1:n] <- data[i,1:n]/data[(i-1),1:n]
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
toets[1,n+2] <- 100
toets[i,n+2] <- toets[i-1,n+2]*toets[i,n+1]
}
weeg <- function(data,w) {
data <- data[,-1]
data <- na.locf(data, na.rm=FALSE, fromLast=TRUE)
m <- ts(data,start=c(1889,10), end= c(1914,8), frequency = 12)
dec <- decompose(m, "additive")
toets <- as.data.frame(m - dec$seasonal)
n <- ncol(toets)
for(i in 2:299) {
toets[i,1:n] <- data[i,1:n]/data[(i-1),1:n]
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
toets[1,n+2] <- 100
toets[i,n+2] <- toets[i-1,n+2]*toets[i,n+1]
}
return(toets[,c(n+2)])
}
crops$Crops <- weeg(crops,gewig[,1:8])
produce$Produce <- weeg(produce,gewig[,9:12])
pastoral$Pastoral <- weeg(pastoral,gewig[,13:18])
livestock$Livestock <- weeg(livestock,gewig[,19:24])
p.provisions$P.Provisions <- weeg(p.provisions,gewig[,25:30])
a.provisions$A.Provisions <- weeg(a.provisions,gewig[,31:35])
o.provisions$O.Provisions <- weeg(o.provisions,gewig[,36:42])
indices <- cbind(crops[,c("Date","Crops")],produce[,"Produce"],pastoral[,"Pastoral"],livestock[,"Livestock"],
p.provisions[,"P.Provisions"],a.provisions[,"A.Provisions"],o.provisions[,"O.Provisions"])
colnames(indices) <- c("Date","Crops","Produce","Pastoral","Livestock","P.Provisions","A.Provisions","O.Provisions")
indices$Total <- weeg(indices,gewig[,43:49])
#Plot commodity Groups
index_plot <- indices[,c(1,2)]
g1 <- ggplot(index_plot, aes(x=Date,y=Crops,group=1))
g1 <- g1 + geom_line(colour="#F8766D")
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + ggtitle("Crops Index")
g1 <- g1 + ylab("Index Value") + xlab("")
g1 <- g1 + theme(legend.position="none")
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,3)]
g2 <- ggplot(index_plot, aes(x=Date,y=Produce,group=1))
g2 <- g2 + geom_line(colour="#7CAE00")
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + ggtitle("Produce Index")
g2 <- g2 + ylab("Index Value") + xlab("")
g2 <- g2 + theme(legend.position="none")
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,4)]
index_plot[220:299,2] <- NA
g3 <- ggplot(index_plot, aes(x=Date,y=Pastoral,group=1))
g3 <- g3 + geom_line(colour="#00BFC4")
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Pastoral Index")
g3 <- g3 + ylab("Index Value") + xlab("")
g3 <- g3 + theme(legend.position="none")
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,5)]
g4 <- ggplot(index_plot, aes(x=Date,y=Livestock,group=1))
g4 <- g4 + geom_line(colour="#C77CFF")
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + ggtitle("Livestock Index")
g4 <- g4 + ylab("Index Value") + xlab("")
g4 <- g4 + theme(legend.position="none")
g4 <- g4 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g4 <- g4 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
grid.arrange(g1, g3, g2, g4, ncol=2, nrow =2)
index_plot <- indices[,c(1,6)]
g1 <- ggplot(index_plot, aes(x=Date,y=P.Provisions,group=1))
g1 <- g1 + geom_line(colour="#F8766D")
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + ggtitle("Pastoral Provisions Index")
g1 <- g1 + ylab("Index Value") + xlab("")
g1 <- g1 + theme(legend.position="none")
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,7)]
g2 <- ggplot(index_plot, aes(x=Date,y=A.Provisions,group=1))
g2 <- g2 + geom_line(colour="#7CAE00")
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + ggtitle("Agri Provisions Index")
g2 <- g2 + ylab("Index Value") + xlab("")
g2 <- g2 + theme(legend.position="none")
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,8)]
index_plot[220:299,2] <- NA
g3 <- ggplot(index_plot, aes(x=Date,y=O.Provisions,group=1))
g3 <- g3 + geom_line(colour="#00BFC4")
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Other Provisions Index")
g3 <- g3 + ylab("Index Value") + xlab("")
g3 <- g3 + theme(legend.position="none")
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,9)]
g4 <- ggplot(index_plot, aes(x=Date,y=Total,group=1))
g4 <- g4 + geom_line(colour="#C77CFF")
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + ggtitle("Total Index")
g4 <- g4 + ylab("Index Value") + xlab("")
g4 <- g4 + theme(legend.position="none")
g4 <- g4 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g4 <- g4 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
grid.arrange(g1, g2, g3, g4, ncol=2, nrow =2)
data <- crops[,-10]
data <- data[,-1]
data <- na.locf(data, na.rm=FALSE, fromLast=TRUE)
m <- ts(data,start=c(1889,10), end= c(1914,8), frequency = 12)
dec <- decompose(m, "additive")
toets <- as.data.frame(m - dec$seasonal)
n <- ncol(toets)
toets <- diff(log(data))
View(data)
m <- ts(data,start=c(1889,10), end= c(1914,8), frequency = 12)
dec <- decompose(m, "additive")
toets <- as.data.frame(m - dec$seasonal)
n <- ncol(toets)
toets <- diff(log(toets))
log(toets)
diff(log(toets))
?diff
toets <- diff(log(toets),lag=1)
toets <- diff(log(m - dec$seasonal),lag=1)
for(i in 1:298) {
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
#toets[1,n+2] <- 100
#toets[i,n+2] <- toets[i-1,n+2]*toets[i,n+1]
}
n <- ncol(toets)
for(i in 1:298) {
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
#toets[1,n+2] <- 100
#toets[i,n+2] <- toets[i-1,n+2]*toets[i,n+1]
}
toets <- as.dat.frame(diff(log(m - dec$seasonal),lag=1))
for(i in 1:298) {
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
#toets[1,n+2] <- 100
#toets[i,n+2] <- toets[i-1,n+2]*toets[i,n+1]
}
i <- 1
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
toets[i,1:n]
w
weighted.mean(toets[i,1:n],w,na.rm=TRUE)
toets[i,n+1]
toets <- as.data.frame(diff(log(m - dec$seasonal),lag=1))
for(i in 1:298) {
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
#toets[1,n+2] <- 100
#toets[i,n+2] <- toets[i-1,n+2]*toets[i,n+1]
}
data <- data[,-1]
data <- na.locf(data, na.rm=FALSE, fromLast=TRUE)
m <- ts(data,start=c(1889,10), end= c(1914,8), frequency = 12)
dec <- decompose(m, "additive")
n <- ncol(toets)
toets <- as.data.frame(diff(log(m - dec$seasonal),lag=1))
data[1,n+1] <- 100
for(i in 1:298) {
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
data[i+1,n+1] <- data[i,n+1]*exp(toets[i,n+1])
}
data <- data[,-1]
data <- na.locf(data, na.rm=FALSE, fromLast=TRUE)
m <- ts(data,start=c(1889,10), end= c(1914,8), frequency = 12)
dec <- decompose(m, "additive")
n <- ncol(toets)
toets <- as.data.frame(diff(log(m - dec$seasonal),lag=1))
for(i in 1:298) {
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
data[1,n+1] <- 100
data[i+1,n+1] <- data[i,n+1]*exp(toets[i,n+1])
}
data <- crops[,-10]
data <- data[,-1]
data <- na.locf(data, na.rm=FALSE, fromLast=TRUE)
m <- ts(data,start=c(1889,10), end= c(1914,8), frequency = 12)
dec <- decompose(m, "additive")
n <- ncol(toets)
toets <- as.data.frame(diff(log(m - dec$seasonal),lag=1))
for(i in 1:298) {
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
data[1,n+1] <- 100
data[i+1,n+1] <- data[i,n+1]*exp(toets[i,n+1])
}
for(i in 1:298) {
toets[i,n+1] <- weighted.mean(toets[i,1:n],w,na.rm=TRUE)
data[i+1,1] <- data[i,1]*exp(toets[i,n+1])
}
weighted.mean(toets[i,1:n],w,na.rm=TRUE)
toets[i,1:n]
ncol(toets)
toets <- as.data.frame(diff(log(m - dec$seasonal),lag=1))
ncol(toets)
toets[i,1:n]
weighted.mean(toets[i,1:n],w,na.rm=TRUE)
weighted.mean(toets[i,1:n], w, na.rm=TRUE)
for(i in 1:298) {
toets[i,n+1] <- weighted.mean(toets[i,1:n], w, na.rm=TRUE)
}
data <- crops
data <- data[,-1]
data <- data[,-9]
data <- na.locf(data, na.rm=FALSE, fromLast=TRUE)
m <- ts(data,start=c(1889,10), end= c(1914,8), frequency = 12)
dec <- decompose(m, "additive")
toets <- as.data.frame(diff(log(m - dec$seasonal),lag=1))
n <- ncol(toets)
for(i in 1:298) {
toets[i,n+1] <- weighted.mean(toets[i,1:n], w, na.rm=TRUE)
data[i+1,1] <- data[i,1]*exp(toets[i,n+1])
}
weeg <- function(data,w) {
data <- data[,-1]
data <- na.locf(data, na.rm=FALSE, fromLast=TRUE)
m <- ts(data,start=c(1889,10), end= c(1914,8), frequency = 12)
dec <- decompose(m, "additive")
toets <- as.data.frame(diff(log(m - dec$seasonal),lag=1))
n <- ncol(toets)
for(i in 1:298) {
toets[i,n+1] <- weighted.mean(toets[i,1:n], w, na.rm=TRUE)
data[i+1,1] <- data[i,1]*exp(toets[i,n+1])
}
return(data[,1])
}
crops$Crops <- weeg(crops,gewig[,1:8])
crops <- crops[,-10]
crops$Crops <- weeg(crops,gewig[,1:8])
index_plot <- melt(crops[,c(1,10)], id="Date")  # convert to long format
g <- ggplot(data=index_plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_line()
g <- g + ylab("Wheat Index")
g <- g + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank()) + theme(legend.position="bottom")
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g
dev.off()
index_plot <- melt(crops[,c(1,10)], id="Date")  # convert to long format
g <- ggplot(data=index_plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_line()
g <- g + ylab("Wheat Index")
g <- g + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank()) + theme(legend.position="bottom")
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g
produce <- cbind(tobacco=makeindex("tobacco")[,1:2],d.fruit=makeindex(c("dried.fruit","d.fruit"))[,1:2],
wine=makeindex(c("wine","wine.better","wine.ordinary"))[,1:2],brandy=makeindex(c("brandy","brandy.better","brandy.ordinary"))[,1:2])
produce <- produce[,c(1,2,4,6,8)]
colnames(produce)[1] <- "Date"
#PASTORAL PRODUCTS (6):
#c("w.wool","u.wool"),"hides",c("sheep.skins","goat.skins"),"cheese","fat.tallow","soap"
pastoral <- cbind(wool=makeindex(c("w.wool","u.wool"))[,1:2],hides=makeindex(c("hides"))[,1:2],skins=makeindex(c("sheep.skins","goat.skins"))[,1:2],
cheese=makeindex("cheese")[,1:2],fat.tallow=makeindex("fat.tallow")[,1:2],soap=makeindex("soap")[,1:2])
pastoral <- pastoral[,c(1,2,4,6,8,10,12)]
colnames(pastoral)[1] <- "Date"
#LIVESTOCK (6):
#c("cattle","tr.oxen","mi.cows","d.oxen","m.cows"),c("s.horse","d.horse","mules","asses"),c("sheep","wo.sheep","w.sheep","c.sheep"),
#"swine","goats",c("fowls","ducks")
livestock <- cbind(cattle=makeindex(c("cattle","tr.oxen","mi.cows","d.oxen","m.cows"))[,1:2],horses=makeindex(c("s.horse","d.horse","mules","asses"))[,1:2],
sheep=makeindex(c("sheep","wo.sheep","w.sheep","c.sheep"))[,1:2],swine=makeindex("swine")[,1:2],goats=makeindex("goats")[,1:2],
fowls=makeindex(c("fowls","ducks"))[,1:2])
livestock <- livestock[,c(1,2,4,6,8,10,12)]
colnames(livestock)[1] <- "Date"
#PROVISIONS (6 + 5 + 7):
#"beef","mutton",c("pork","bacon"),"eggs",c("butter","butter.fresh","butter.salt"),"bread",c("beer.eng","beer.col"),c("wheat.flour","flour"),"mealie.meal","boer.meal","oatmeal"
#"tea","coffee","sugar","rice","salt","milk","candles"
p.provisions <- cbind(beef=makeindex("beef")[,1:2],mutton=makeindex("mutton")[,1:2],pork=makeindex(c("pork","bacon"))[,1:2],
eggs=makeindex("eggs")[,1:2],butter=makeindex(c("butter","butter.fresh","butter.salt"))[,1:2],milk=makeindex("milk")[,1:2])
p.provisions <- p.provisions[,c(1,2,4,6,8,10,12)]
colnames(p.provisions)[1] <- "Date"
a.provisions <- cbind(bread=makeindex("bread")[,1:2],flour=makeindex(c("wheat.flour"))[,1:2],
mealie.meal=makeindex("mealie.meal")[,1:2],boer.meal=makeindex("boer.meal")[,1:2],oatmeal=makeindex("oatmeal")[,1:2])
a.provisions <- a.provisions[,c(1,2,4,6,8,10)]
colnames(a.provisions)[1] <- "Date"
o.provisions <- cbind(tea=makeindex("tea")[,1:2],coffee=makeindex("coffee")[,1:2],sugar=makeindex("sugar")[,1:2],beer=makeindex(c("beer.eng","beer.col"))[,1:2],
rice=makeindex("rice")[,1:2],salt=makeindex("salt")[,1:2],candles=makeindex("candles")[,1:2])
o.provisions <- o.provisions[,c(1,2,4,6,8,10,12,14)]
colnames(o.provisions)[1] <- "Date"
produce$Produce <- weeg(produce,gewig[,9:12])
pastoral$Pastoral <- weeg(pastoral,gewig[,13:18])
livestock$Livestock <- weeg(livestock,gewig[,19:24])
p.provisions$P.Provisions <- weeg(p.provisions,gewig[,25:30])
a.provisions$A.Provisions <- weeg(a.provisions,gewig[,31:35])
o.provisions$O.Provisions <- weeg(o.provisions,gewig[,36:42])
indices <- cbind(crops[,c("Date","Crops")],produce[,"Produce"],pastoral[,"Pastoral"],livestock[,"Livestock"],
p.provisions[,"P.Provisions"],a.provisions[,"A.Provisions"],o.provisions[,"O.Provisions"])
colnames(indices) <- c("Date","Crops","Produce","Pastoral","Livestock","P.Provisions","A.Provisions","O.Provisions")
indices$Total <- weeg(indices,gewig[,43:49])
#Plot commodity Groups
index_plot <- indices[,c(1,2)]
g1 <- ggplot(index_plot, aes(x=Date,y=Crops,group=1))
g1 <- g1 + geom_line(colour="#F8766D")
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + ggtitle("Crops Index")
g1 <- g1 + ylab("Index Value") + xlab("")
g1 <- g1 + theme(legend.position="none")
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,3)]
g2 <- ggplot(index_plot, aes(x=Date,y=Produce,group=1))
g2 <- g2 + geom_line(colour="#7CAE00")
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + ggtitle("Produce Index")
g2 <- g2 + ylab("Index Value") + xlab("")
g2 <- g2 + theme(legend.position="none")
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,4)]
index_plot[220:299,2] <- NA
g3 <- ggplot(index_plot, aes(x=Date,y=Pastoral,group=1))
g3 <- g3 + geom_line(colour="#00BFC4")
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Pastoral Index")
g3 <- g3 + ylab("Index Value") + xlab("")
g3 <- g3 + theme(legend.position="none")
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,5)]
g4 <- ggplot(index_plot, aes(x=Date,y=Livestock,group=1))
g4 <- g4 + geom_line(colour="#C77CFF")
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + ggtitle("Livestock Index")
g4 <- g4 + ylab("Index Value") + xlab("")
g4 <- g4 + theme(legend.position="none")
g4 <- g4 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g4 <- g4 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
grid.arrange(g1, g3, g2, g4, ncol=2, nrow =2)
index_plot <- indices[,c(1,6)]
g1 <- ggplot(index_plot, aes(x=Date,y=P.Provisions,group=1))
g1 <- g1 + geom_line(colour="#F8766D")
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + ggtitle("Pastoral Provisions Index")
g1 <- g1 + ylab("Index Value") + xlab("")
g1 <- g1 + theme(legend.position="none")
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,7)]
g2 <- ggplot(index_plot, aes(x=Date,y=A.Provisions,group=1))
g2 <- g2 + geom_line(colour="#7CAE00")
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + ggtitle("Agri Provisions Index")
g2 <- g2 + ylab("Index Value") + xlab("")
g2 <- g2 + theme(legend.position="none")
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,8)]
index_plot[220:299,2] <- NA
g3 <- ggplot(index_plot, aes(x=Date,y=O.Provisions,group=1))
g3 <- g3 + geom_line(colour="#00BFC4")
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Other Provisions Index")
g3 <- g3 + ylab("Index Value") + xlab("")
g3 <- g3 + theme(legend.position="none")
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
index_plot <- indices[,c(1,9)]
g4 <- ggplot(index_plot, aes(x=Date,y=Total,group=1))
g4 <- g4 + geom_line(colour="#C77CFF")
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + ggtitle("Total Index")
g4 <- g4 + ylab("Index Value") + xlab("")
g4 <- g4 + theme(legend.position="none")
g4 <- g4 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g4 <- g4 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
grid.arrange(g1, g2, g3, g4, ncol=2, nrow =2)
##For Grpahing Business cycles
alt_recessions.df = read.table(textConnection(
"Peaks, Troughs
1889-12-31, 1894-12-31
1899-12-31, 1900-12-31
1906-12-31, 1909-12-31"), sep=',',
colClasses=c('Date','Date'), header=TRUE)
#png(file = "Commodity_plot.png", width=720,height=480)
indicator_plot <- indices[,c("Date","Total")]
g <- ggplot(indicator_plot)
g <- g + labs(color="Legend text")
g <- g + geom_line(aes(x=Date, y=Total, colour="Total"), size = 1)
g <- g + geom_rect(data=tp[-1:-7,], aes(xmin=Peaks, xmax=Troughs, ymin=-Inf, ymax=+Inf), fill='grey', alpha=0.5)
g <- g + ylab("Index") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
#g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"),expand=c(0,0),
#                      limits = as.Date(c("1888-12-31", NA)))
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g <- g + theme(legend.position="none")
g
#Calculate annual average
indices$Year <- format(indices$Date,format="%Y")
annual_index <- aggregate(Total ~ Year, indices, FUN=mean)
annual_index$Total_Index <- annual_index$Total/103.73851*100
maak_indeks <- function(indeks) {
for(i in 2:ncol(indeks)) {
indeks[,i] <- indeks[,i]/indeks[1,i]*100
}
return(indeks)
}
temp_indices <- cbind(CPI[-1:-9,],annual_index$Total)
temp_indices <- maak_indeks(temp_indices)
index_plot <- melt(temp_indices, id="Date")  # convert to long format
g <- ggplot(data=index_plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_point(size = 1)
g <- g + geom_line()
g <- g + ylab("Index")
g <- g + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank()) + theme(legend.position="bottom")
g
#Check correlations (in levels)
source("corstarsl.R")
temp_indices <- cbind(CPI[-1:-9,-1],annual_index$Total)
for(i in 2:ncol(temp_indices)) {temp_indices[,i] <- as.numeric(temp_indices[,i]) }
ts.all_indices <- as.ts(temp_indices,start=1889, end= 1914, frequency = 1)
xt <- xtable(corstarsl(ts.all_indices), caption="Correlations in Levels")
print(xt, "latex",comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"))
corstarsl(ts.all_indices)
UK <- read.csv("UK.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
UK$Date <- indices$Date
UK <- cbind(UK,Cape.Wholesale.Index=indices$Total,Cape.Wheat.Index=crops$wheat.Total_Index)
maak_indeks <- function(indeks) {
for(i in 2:ncol(indeks)) {
indeks[,i] <- indeks[,i]/mean(indeks[1:4,i],na.rm=TRUE)*100
}
return(indeks)
}
UK <- maak_indeks(UK)
index_plot <- melt(UK[,c(1,2,6)], id="Date")  # convert to long format
g1 <- ggplot(data=index_plot,aes(x=Date, y=value, group=variable, colour=variable))
g1 <- g1 + geom_point(size = 1)
g1 <- g1 + geom_line()
g1 <- g1 + ylab("Index")
g1 <- g1 + xlab("")
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + theme(legend.title=element_blank()) + theme(legend.position="bottom")
index_plot <- melt(UK[,c(1,3,4,5)], id="Date")  # convert to long format
g2 <- ggplot(data=index_plot,aes(x=Date, y=value, group=variable, colour=variable))
g2 <- g2 + geom_point(size = 1)
g2 <- g2 + geom_line()
g2 <- g2 + ylab("")
g2 <- g2 + xlab("")
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + theme(legend.title=element_blank()) + theme(legend.position="bottom")
grid.arrange(g1, g2, ncol=2, nrow =1)
#Check correlations (in levels)
source("corstarsl.R")
temp_indices <- UK[,c(-1)]
for(i in 2:ncol(temp_indices)) {temp_indices[,i] <- as.numeric(temp_indices[,i]) }
ts.all_indices <- as.ts(temp_indices, start=c(1889,10),end=c(1914,8), frequency = 12)
xt <- xtable(corstarsl(ts.all_indices), caption="Correlations in Levels")
print(xt, "latex",comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"))
corstarsl(ts.all_indices)
#png(file = "Commodity_plot.png", width=720,height=480)
indicator_plot <- cbind(GDP[-1:-33,c("Date", "Currency")],annual_index$Total[-22:-26])
colnames(indicator_plot) <- c("Date","Currency","WPI")
indicator_plot[,-1] <- scale(indicator_plot[,-1])
g <- ggplot(indicator_plot)
#g <- g + labs(color="Legend text")
g <- g + geom_line(aes(x=Date, y=WPI, colour="WPI"), size = 1)
g <- g + geom_line(aes(x=Date, y=Currency, colour="Currency"), size = 1)
g <- g + geom_rect(data=tp[-1:-7,], aes(xmin=Peaks, xmax=Troughs, ymin=-Inf, ymax=+Inf), fill='grey', alpha=0.5)
g <- g + ylab("Index") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g <- g + theme(legend.position="bottom")
g
#dev
temp_indices <- indicator_plot[,-1]
xt <- xtable(corstarsl(temp_indices), caption="Correlations in Levels")
print(xt, "latex",comment=FALSE, caption.placement = getOption("xtable.caption.placement", "top"))
#png(file = "Commodity_plot.png", width=720,height=480)
indicator_plot <- cbind(GDP[-1:-33,c("Date", "Currency")],annual_index$Total[-22:-26])
colnames(indicator_plot) <- c("Date","Currency","WPI")
indicator_plot[,-1] <- scale(indicator_plot[,-1])
g <- ggplot(indicator_plot)
#g <- g + labs(color="Legend text")
g <- g + geom_line(aes(x=Date, y=WPI, colour="WPI"), size = 1)
g <- g + geom_line(aes(x=Date, y=Currency, colour="Currency"), size = 1)
g <- g + geom_rect(data=tp[-1:-7,], aes(xmin=Peaks, xmax=Troughs, ymin=-Inf, ymax=+Inf), fill='grey', alpha=0.5)
g <- g + ylab("Index") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g <- g + theme(legend.position="bottom")
g
